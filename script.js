const out = document.getElementById('out'); const balBtn = document.getElementById('bal'); const buyBtn = document.getElementById('buy'); const propBtn = document.getElementById('proposal'); const modeSel = document.getElementById('mode'); const symbol = document.getElementById('symbol'); const amount = document.getElementById('amount'); const duration = document.getElementById('duration'); function log(m){ out.textContent = m + '\n' + out.textContent; } propBtn.addEventListener('click', async ()=>{ log('Requesting proposal...'); try{ const res = await fetch('/api/proposal',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({symbol:symbol.value, amount:Number(amount.value), duration:Number(duration.value), contract_type:'CALL'})}); const j = await res.json(); log('Proposal: '+JSON.stringify(j)); }catch(e){ log('Error: '+e.message); } }); buyBtn.addEventListener('click', async ()=>{ log('Placing buy...'); try{ const res = await fetch('/api/buy',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({ proposal_id: null, amount:Number(amount.value) })}); const j = await res.json(); log('Buy: '+JSON.stringify(j)); }catch(e){ log('Error: '+e.message); } }); balBtn.addEventListener('click', async ()=>{ log('Checking balance...'); try{ const res = await fetch('/api/balance'); const j = await res.json(); log('Balance: '+JSON.stringify(j)); }catch(e){ log('Error: '+e.message); } }); (async ()=>{ try{ const s = await fetch('/api/history'); const h = await s.json(); if(Array.isArray(h)) { log('Loaded history: '+h.length+' records'); } }catch(e){} })();